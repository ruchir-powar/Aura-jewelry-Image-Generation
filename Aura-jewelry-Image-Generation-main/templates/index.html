{% extends "base.html" %}
{% block title %}Home Â· JewelGen AI{% endblock %}

{% block styles %}
<style>
  .sr-only {
    position: absolute; width: 1px; height: 1px; padding: 0; margin: -1px;
    overflow: hidden; clip: rect(0,0,0,0); white-space: nowrap; border: 0;
  }

  .form-wrap { max-width: 1100px; margin: 0 auto; padding: 12px 16px 60px; }
  .form-section {
    background:#fffdf1; border:1px solid #f3f4f6; border-radius: var(--radius);
    box-shadow: var(--shadow); padding: 22px;
  }

  .section-head { display:flex; align-items:center; justify-content:space-between; gap:12px; margin: 0 0 14px; }
  .section-head h1 { font-size: clamp(24px, 3vw, 32px); margin:0; }
  .section-head .hint { color: var(--muted); font-size: 14px; }

  .dropdown-grid { display:grid; grid-template-columns: repeat(12, 1fr); gap: 16px; margin: 14px 0; }
  .dropdown-group { grid-column: span 12; display:flex; flex-direction:column; gap:8px; }
  @media (min-width: 720px) { .dropdown-group { grid-column: span 4; } }

  label { font-weight: 700; color:#334155; font-size: 14px; }
  select, textarea {
    width:100%; border:1px solid #e5e7eb; border-radius: 12px;
    padding: 12px; background:#fff; color:#111827; min-height: 42px;
  }
  select:focus, textarea:focus { outline: 2px solid #ffe26b; outline-offset: 2px; }

  .actions { display:flex; gap:10px; flex-wrap:wrap; }
  #promptBox, #finalPrompt { min-height: 110px; resize: vertical; margin-top: 10px; }

  .preview-title { font-size: 18px; color:#374151; }
  .preview-container { display:grid; grid-template-columns: repeat(12, 1fr); gap: 16px; }
  .preview-frame {
    grid-column: span 12; background:#fff; border:1px solid #f3f4f6;
    border-radius: 16px; box-shadow: var(--shadow); padding: 10px;
    min-height: 220px; display:grid; place-items:center;
  }
  .preview-frame img { max-height: 360px; object-fit: contain; }
  @media (min-width: 860px) { .preview-frame { grid-column: span 6; min-height: 280px; } }

  .divider {
    height:1px;
    background: linear-gradient(90deg, transparent, #f1f5f9 20%, #f1f5f9 80%, transparent);
    margin: 18px 0;
  }
</style>
{% endblock %}

{% block content %}
<section aria-labelledby="generate-heading" class="app-section reveal">
  <div class="container form-wrap">
    <div class="section-head">
      <h1 id="generate-heading">
        <span style="background:linear-gradient(90deg,#111827,#4b5563);-webkit-background-clip:text;background-clip:text;color:transparent;">Generate</span>
        Â· Prompt Builder
      </h1>
      <p class="hint">Lightweight, production-ready prompts with your yellow-theme âœ¨</p>
    </div>

    <div class="form-section">
      <!-- Dropdown rows -->
      <div class="dropdown-grid">
        <div class="dropdown-group"><label for="jewelryType">Jewelry Type</label><select id="jewelryType"><option value="">-- Select --</option></select></div>
        <div class="dropdown-group"><label for="jewelrySubCategory">Jewelry Sub Category</label><select id="jewelrySubCategory"><option value="">-- Select --</option></select></div>
        <div class="dropdown-group"><label for="metalType">Metal Type</label><select id="metalType"><option value="">-- Select --</option></select></div>
      </div>
      <div class="dropdown-grid">
        <div class="dropdown-group"><label for="jewelryStyle">Jewelry Style</label><select id="jewelryStyle"><option value="">-- Select --</option></select></div>
        <div class="dropdown-group"><label for="gemstoneType">Gemstone Type</label><select id="gemstoneType"><option value="">-- Select --</option></select></div>
        <div class="dropdown-group"><label for="diamondShape">Diamond Shape</label><select id="diamondShape"><option value="">-- Select --</option></select></div>
      </div>
      <div class="dropdown-grid">
        <div class="dropdown-group"><label for="settingStyle">Setting Style</label><select id="settingStyle"><option value="">-- Select --</option></select></div>
        <div class="dropdown-group"><label for="stoneArrangement">Stone Arrangement</label><select id="stoneArrangement"><option value="">-- Select --</option></select></div>
        <div class="dropdown-group"><label for="caratWeight">Carat Weight</label><select id="caratWeight"><option value="">-- Select --</option></select></div>
      </div>
      <div class="dropdown-grid">
        <div class="dropdown-group"><label for="sizeRange">Size Range</label><select id="sizeRange"><option value="">-- Select --</option></select></div>
        <div class="dropdown-group">
          <label for="numDiamonds">Number of Diamonds</label>
          <select id="numDiamonds"><option value="">-- Select --</option>{% for i in range(1,11) %}<option value="{{i}}">{{i}}</option>{% endfor %}</select>
        </div>
        <div class="dropdown-group"><label for="goldWeight">Gold Weight</label><select id="goldWeight"><option value="">-- Select --</option></select></div>
      </div>

      <div class="divider"></div>

      <!-- Actions -->
      <div class="actions">
        <button id="generateBtn" class="btn primary" type="button">Generate Prompt</button>
        <div style="flex:1"></div>
        <div class="dropdown-group" style="flex:0 0 220px; margin:0;">
          <label for="imageCount" style="margin:0;">Images</label>
          <select id="imageCount"><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option></select>
        </div>
        <button id="generateJewelryBtn" class="btn" type="button">Generate Jewelry</button>
        <button id="downloadImageBtn" class="btn" type="button">Download Image</button>
      </div>

      <!-- Prompt + Preview -->
      <textarea id="promptBox" placeholder="Your prompt will appear here..."></textarea>
      <h2 class="preview-title" style="text-align:center; margin:30px auto 10px;">Preview ðŸ“¸</h2>
      <div id="previewContainer" class="preview-container">
        <div class="preview-frame" id="previewFrame-0"><img id="previewImage-0" src="" alt="Generated jewelry preview" /></div>
      </div>

      <div id="resultSection" class="mt-20">
        <textarea id="finalPrompt" readonly placeholder="Your generated prompt will appear hereâ€¦"></textarea>
      </div>
    </div>
  </div>
</section>
{% endblock %}

{% block scripts %}
<!-- Expose API endpoint to JS -->
<meta name="api-generate" content="/generate">

<!-- Load and run the page module -->
<script type="module">
  import { initIndex } from "/static/js/pages/indexPage.js";
  document.body.dataset.page = "index";
  initIndex();
</script>
{% endblock %}
